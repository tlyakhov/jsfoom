<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <title>jsFoom</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Foom"/>
    <meta name="keywords" content="foom"/>
    <meta name="author" content="Tim Lyakhovetskiy"/>

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
    <link href='http://fonts.googleapis.com/css?family=Cabin:500,500italic,700,700italic' rel='stylesheet'
          type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700' rel='stylesheet' type='text/css'>
    <!-- Optional theme -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//code.jquery.com/jquery.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/editor.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link href="//cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet"/>
    <link href="//cdn.kendostatic.com/2014.2.716/styles/kendo.default.min.css" rel="stylesheet"/>
    <script src="//cdn.kendostatic.com/2014.2.716/js/jquery.min.js"></script>
    <script src="//cdn.kendostatic.com/2014.2.716/js/kendo.ui.core.min.js"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.2/css/jquery.dataTables.css">
    <!-- DataTables -->
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.2/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" type="text/css"
          href="//cdn.datatables.net/plug-ins/725b2a2115b/integration/bootstrap/3/dataTables.bootstrap.css">
    <script type="text/javascript"
            src="//cdn.datatables.net/plug-ins/725b2a2115b/integration/bootstrap/3/dataTables.bootstrap.js"></script>

    <script src="js/game/constants.js"></script>
    <script src="js/lib/object_id.js"></script>
    <script src="js/engine/utils.js"></script>
    <script src="js/engine/object_cache.js"></script>
    <script src="js/engine/vector3.js"></script>
    <script src="js/engine/texture.js"></script>
    <script src="js/engine/texture_cache.js"></script>
    <script src="js/engine/material.js"></script>
    <script src="js/engine/map_segment.js"></script>
    <script src="js/engine/map_sector.js"></script>
    <script src="js/engine/map_sector_water.js"></script>
    <script src="js/engine/map_sector_vertical_door.js"></script>
    <script src="js/engine/sprite.js"></script>
    <script src="js/engine/entity.js"></script>
    <script src="js/engine/static_entity.js"></script>
    <script src="js/engine/light_entity.js"></script>
    <script src="js/engine/player.js"></script>
    <script src="js/engine/map.js"></script>
    <script src="js/engine/render_slice.js"></script>
    <script src="js/engine/renderer.js"></script>
    <script src="js/game/sprite_sets.js"></script>
    <script src="js/game/test_map.js"></script>
    <script src="js/game/input.js"></script>
    <script src="js/game/main.js"></script>
    <script src="js/engine/editor.js"></script>
    <script>
        var globalGame = new GameMain({
            screenWidth: 640,
            screenHeight: 360,
            canvasId: 'render-canvas',
            map: Map.deserialize(testMap)
        });

        var globalEditor = new Editor({
            canvasId: 'edit-canvas',
            propEditorId: 'prop-editor',
            toolbarId: 'toolbar',
            map: globalGame.map
        });

        function triggerResize() {
            $('#main-splitter').data('kendoSplitter').trigger('resize');
        }
        function onMainResize(e) {
            $('#edit-canvas').attr('width', $('#edit-view').width());
            $('#edit-canvas').attr('height', $('#edit-view').height());
        }

        $(document).ready(function () {
            $('#main-splitter').kendoSplitter({
                resize: onMainResize
            });
            $('#prop-splitter').kendoSplitter({
                orientation: 'vertical',
                panes: [
                    { size: '' + ($('#prop-splitter').width() * 9 / 16) + 'px' },
                    { }
                ]
            });

            $(window).resize(triggerResize);

            globalGame.go();
            globalEditor.go();
        });
    </script>
</head>
<body onkeydown="keyDown(event);return false;"
      onkeyup="keyUp(event); return false;">
<div class="container">
    <div id="toolbar">
    </div>
    <div id="main-splitter">
        <div id="edit-view">
            <canvas id="edit-canvas">
            </canvas>
            </div>
        <div id="prop-view">
            <div id="prop-splitter">
                <div id="render-view">
                    <canvas id="render-canvas">
                    </canvas>
                </div>
                <div id="prop-editor-view">
                    <table cellpadding="0" cellspacing="0" border="0" id="prop-editor" class="display compact"></table>
                </div>
            </div>
        </div>
        </div>
</div>
</body>
</html>