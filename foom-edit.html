<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <title>jsFoom</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Foom"/>
    <meta name="keywords" content="foom"/>
    <meta name="author" content="Tim Lyakhovetskiy"/>

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
    <link href='http://fonts.googleapis.com/css?family=Cabin:500,500italic,700,700italic' rel='stylesheet'
          type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700' rel='stylesheet' type='text/css'>
    <!-- Optional theme -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//code.jquery.com/jquery-2.0.3.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css"
          rel="stylesheet"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/js/bootstrap-editable.min.js"></script>
    <!-- Select2 -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.css"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.min.js"></script>
    <!-- Kendo UI -->
    <link href="//cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet"/>
    <link href="//cdn.kendostatic.com/2014.2.716/styles/kendo.default.min.css" rel="stylesheet"/>
    <script src="//cdn.kendostatic.com/2014.2.716/js/kendo.ui.core.min.js"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.2/css/jquery.dataTables.css">
    <!-- DataTables -->
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.2/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" type="text/css"
          href="//cdn.datatables.net/plug-ins/725b2a2115b/integration/bootstrap/3/dataTables.bootstrap.css">
    <script type="text/javascript"
            src="//cdn.datatables.net/plug-ins/725b2a2115b/integration/bootstrap/3/dataTables.bootstrap.js"></script>

    <!-- Bootbox -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.2.0/bootbox.min.js"></script>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
    <link href='http://fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/editor.css">
    <script src="js/lib/object_id.js"></script>
    <script src="js/lib/hashcode.js"></script>
    <script src="js/game/constants.js"></script>
    <script src="js/engine/utils.js"></script>
    <script src="js/engine/object_cache.js"></script>
    <script src="js/engine/vector3.js"></script>
    <script src="js/engine/texture.js"></script>
    <script src="js/engine/texture_cache.js"></script>
    <script src="js/engine/material.js"></script>
    <script src="js/engine/map_segment.js"></script>
    <script src="js/engine/sectors/map_sector.js"></script>
    <script src="js/engine/sectors/map_sector_water.js"></script>
    <script src="js/engine/sectors/map_sector_vertical_door.js"></script>
    <script src="js/engine/sprite.js"></script>
    <script src="js/engine/entities/entity.js"></script>
    <script src="js/engine/entities/renderable_entity.js"></script>
    <script src="js/engine/entities/sprite_entity.js"></script>
    <script src="js/engine/entities/light_entity.js"></script>
    <script src="js/engine/entities/behaviors/behavior.js"></script>
    <script src="js/engine/entities/behaviors/light_behavior.js"></script>
    <script src="js/engine/entities/behaviors/inventory_item_behavior.js"></script>
    <script src="js/engine/entities/behaviors/talk_behavior.js"></script>
    <script src="js/engine/entities/behaviors/wander_behavior.js"></script>
    <script src="js/engine/entities/behaviors/waypoint_behavior.js"></script>
    <script src="js/engine/entities/behaviors/talk_action.js"></script>
    <script src="js/engine/entities/behaviors/talk_action_say.js"></script>
    <script src="js/engine/entities/behaviors/talk_action_give.js"></script>
    <script src="js/engine/player.js"></script>
    <script src="js/engine/map.js"></script>
    <script src="js/engine/render_slice.js"></script>
    <script src="js/engine/renderer.js"></script>
    <script src="js/game/input.js"></script>
    <script src="js/game/main.js"></script>
    <script src="js/engine/editor/default_map.js"></script>
    <script src="js/engine/editor/map_point.js"></script>
    <script src="js/engine/editor/editor.js"></script>
    <script src="js/engine/editor/editor_storage.js"></script>
    <script src="js/engine/editor/editor_property_grid.js"></script>
    <script src="js/engine/editor/actions/editor_action.js"></script>
    <script src="js/engine/editor/actions/select_editor_action.js"></script>
    <script src="js/engine/editor/actions/delete_editor_action.js"></script>
    <script src="js/engine/editor/actions/move_editor_action.js"></script>
    <script src="js/engine/editor/actions/add_entity_editor_action.js"></script>
    <script src="js/engine/editor/actions/add_sector_editor_action.js"></script>
    <script src="js/engine/editor/actions/pan_editor_action.js"></script>
    <script src="js/engine/editor/actions/scissor_editor_action.js"></script>
    <script src="js/engine/editor/actions/split_editor_action.js"></script>
    <script src="js/engine/editor/actions/set_property_editor_action.js"></script>
    <script src="js/engine/editor/actions/array_property_editor_action.js"></script>

    <script>
        var globalGame = new GameMain({
            screenWidth: 640,
            screenHeight: 360,
            canvasId: 'render-canvas',
            map: Map.deserialize(globalDefaultMap),
            loadedCallback: function() { globalEditor.go(); }
        });

        var globalEditor = new Editor({
            canvasId: 'edit-canvas',
            propEditorId: 'prop-editor',
            toolbarId: 'toolbar',
            menuId: 'menu',
            propExtrasId: 'prop-extras',
            map: globalGame.map
        });

        globalGame.map.entitiesPaused = true;
        globalGame.pickCallback = $.proxy(globalEditor.gamePick, globalEditor);

        function triggerResize() {
            $('#main-splitter').data('kendoSplitter').trigger('resize');
        }
        function onMainResize(e) {
            $('#edit-canvas').attr('width', $('#edit-view').width());
            $('#edit-canvas').attr('height', $('#edit-view').height());
        }

        $(document).ready(function () {
            $('#main-splitter').kendoSplitter({
                resize: onMainResize
            });
            $('#prop-splitter').kendoSplitter({
                orientation: 'vertical',
                panes: [
                    { size: '' + ($('#prop-splitter').width() * 9 / 16) + 'px' },
                    { }
                ]
            });

            $(window).resize(triggerResize);

            globalGame.go();

            triggerResize();
        });
    </script>
</head>
<body>
<div class="container">
    <div id="menu-container">
        <ul id="menu">
            <li>
                File
                <ul>
                    <li id="menu-file-new">New (CTRL+N)</li>
                    <li id="menu-file-open">Open (CTRL+O)</li>
                    <li id="menu-file-save">Save (CTRL+S)</li>
                    <li id="menu-file-save-as">Save As (CTRL+A)</li>
                    <li id="menu-file-download">Download</li>
                </ul>
            </li>
            <li>
                Edit
                <ul>
                    <li id="menu-edit-undo">Undo (CTRL+Z)</li>
                    <li id="menu-edit-redo">Redo (CTRL+Y)</li>
                    <li id="menu-edit-delete">Delete (DEL/BACKSPACE)</li>
                    <li class="k-ext-menu-separator">
                        <hr/>
                    </li>
                    <li id="menu-edit-tool-default">Default Tool (X)</li>
                    <li id="menu-edit-tool-add-sector">Add Sector Tool (S)</li>
                    <li id="menu-edit-tool-add-entity">Add Entity Tool (E)</li>
                </ul>
            </li>
            <li>
                View
                <ul>
                    <li id="menu-view-center-on-player"><i class="fa fa-check fa-fw"></i> Center
                        on Player
                    </li>
                    <li id="menu-view-show-grid"><i class="fa fa-check fa-fw"></i> Show Grid</li>
                    <li id="menu-view-show-entities"><i class="fa fa-check fa-fw"></i> Show Entities</li>
                    <li id="menu-view-show-sector-types"><i class="fa fa-check fa-fw"></i> Show Sector Types</li>
                    <li id="menu-view-show-entity-types"><i class="fa fa-check fa-fw"></i> Show Entity Types</li>
                    <li id="menu-view-entities-paused"><i class="fa fa-check fa-fw"></i> Entities Paused</li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="toolbar">
    </div>
    <div id="main-splitter">
        <div id="edit-view">
            <canvas id="edit-canvas" tabindex="1">
            </canvas>
        </div>
        <div id="prop-view">
            <div id="prop-splitter">
                <div id="render-view">
                    <canvas id="render-canvas" tabindex="2" onmousedown="$('#render-canvas').focus();"
                            onkeydown="keyDown(event);return false;"
                            onkeyup="keyUp(event); return false;">
                    </canvas>
                </div>
                <div id="prop-editor-view">
                    <div id="prop-extras">
                    </div>
                    <table cellpadding="0" cellspacing="0" border="0" id="prop-editor" class="display compact"></table>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>